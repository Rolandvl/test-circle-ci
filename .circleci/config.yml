# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

jobs:
  say-something:
    parameters:
      - instance:
        type: enum
        enum: ["A", "B", "C"]
        default: "A"
      - pod:
        type: enum
        enum: ["standard", "cluster"]
        default: "standard"
    - run:
        name: job 
        command: echo "deploy <<parameters.instance>>  on  <<parameters.pod>>"
  


# Invoke jobs via workflows
# See: https://circleci.com/docs/2.0/configuration-reference/#workflows

parameters:
  try_deploy:
    type: boolean
    default: false
  game:
    type: enum 
    enum : ["A", "B", "C"]
    default: "A"


workflows_std:
  when:
    - and:
      - << pipeline.parameters.try_deploy >>
      - or:
            - equal: [ "A", << pipeline.game >> ]
            - equal: [ "B", << pipeline.game >> ]
  say-workflow:
    jobs:
      - say-something:
        instance: << pipeline.game >>
        pod: "standard"

workflows_cluster:
  when:
    - and:
      - << pipeline.parameters.try_deploy >>
      - or:
            - equal: [ "C", << pipeline.game >> ]
  say-workflow:
    jobs:
      - say-something:
        instance: << pipeline.game >>
        pod: "cluster"



